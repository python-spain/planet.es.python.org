<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es" lang="es">








<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="noarchive" />
    <meta http-equiv="Refresh" content="1800" />
    <link rel="shortcut icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <link rel="alternate" type="application/rss+xml" title="
    planet.es.python.org
" href="/rss.xml" />
    <title>
    planet.es.python.org
</title>
</head>
<body id="rawdog">
<div id="header">
    <h1><a href="/" style="color: black;">planet.<span style="color:#d40000">e</span><span style="color:#f3b52c">s</span>.<span style="color:#43648b">pyt</span><span style="color:#f3b52c">hon</span>.org</a></h1>
</div>
<div id="items">
<div class="day">
<h2>mi&#233;rcoles, 09 agosto</h2>
<div class="time">
<h3>14:41</h3>
<div class="item feed-207d1418 feed-{feed_id}" id="item-d0f32908">
<p class="itemheader">
<span class="itemtitle">
    El Ornitorrinco Enmascarado:
<a href="http://www.elornitorrincoenmascarado.com/2017/08/ejemplo-de-uso-de-pyparsing.html">Ejemplo de uso de pyparsing</a></span>
</p>
    <div class="itemdescription">
    <div class="cell border-box-sizing text_cell rendered"><div class="inner_cell"><div class="text_cell_render border-box-sizing rendered_html" style="border-style: none; margin: 0px; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;"><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;">Nota: La versi&#243;n m&#225;s actualizada de este documento est&#225; siempre en</h2><h4><a href="https://github.com/euribates/Charla-DSL/blob/master/Ejemplo-uso-pyparsing.ipynb">https://github.com/euribates/Charla-DSL/blob/master/Ejemplo-uso-pyparsing.ipynb</a></h4><h2 id="Ejemplo-de-uso-de-pyparsing" style="color: inherit; font-family: inherit; font-size: 21.994px; font-weight: bold; line-height: 1;">Ejemplo de uso de pyparsing<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Ejemplo-de-uso-de-pyparsing" style="background-color: transparent; color: #337ab7; padding: 0px 20px; text-decoration: none;"></a></h2><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell rendered unselected" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div style="margin-top: 1em;">Vamos a utilizar&nbsp;<a href="http://pyparsing.wikispaces.com/home" style="background-color: transparent; color: #337ab7;" target="_blank">pyparsing</a>&nbsp;para procesar un fichero csv. Para hacer las cosas m&#225;s interesantes, supondremos que el formato de los ficheros es muy laxo; por ejemplo, podemos encontrarnos con lo siguiente:</div><ul style="margin: 1em 2em 0em; padding-left: 0px;"><li><div>Los campos de texto pueden venir entrecomillados o no</div></li><li><div>Los campos de tipo fecha pueden venir en dos formatos: YYYY-MM-DD o DD/MM/YYYY</div></li><li><div>Los campos de tipo booleano pueden venir con los valores&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">1</code>,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">S</code>,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Y</code>&nbsp;o&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">True</code>&nbsp;para el valor l&#243;gico verdadero, y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">0</code>,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">N</code>,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">F</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">False</code>&nbsp;para el valor l&#243;gico falso</div></li><li><div>Los n&#250;meros decimales pueden venir con una coma o con un punto como separador decimal.</div></li><li><div>La primera l&#237;nea contiene los nombres de los campos, el resto los datos; en los dos casos se separa cada valor por el caracter&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">;</code></div></li></ul></div></div></div><div class="cell text_cell rendered selected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Ejemplo-de-datos-a-procesar" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Ejemplo de datos a procesar<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Ejemplo-de-datos-a-procesar" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell rendered selected" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div style="margin-top: 1em;">Algo como esto:</div><pre style="border-radius: 2px; border: 0px; line-height: inherit; margin: 1em 2em; overflow: auto; padding: 0px; white-space: pre-wrap;"><code style="border-radius: 0px; border: 0px; padding: 0px;">Comentario;Activo;Fecha;Importe<br />Texto sin comillas porque yo lo valgo;Y;2017-08-08;4292.00<br />"Ahora si que pongo comillas";F;25/8/2014;3200.00<br />Ya ves, todo vale;True;1/1/1970;4532,02<br /></code></pre></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Una-gramatica-para-estos-ficheros" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Una gramatica para estos ficheros<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Una-gramatica-para-estos-ficheros" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell unselected rendered" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div style="margin-top: 1em;">La gram&#225;tica podr&#237;a ser algo as&#237;:</div><pre style="border-radius: 2px; border: 0px; line-height: inherit; margin: 1em 2em; overflow: auto; padding: 0px; white-space: pre-wrap;"><code style="border-radius: 0px; border: 0px; padding: 0px;">root -&gt; header + lines<br />header -&gt; \.+ # ignorar la linea <br />lines -&gt; line+<br />line -&gt; text + sep + date + sep + bool + sep + cost<br />text -&gt; '"' + literal + '"' | literal<br />date -&gt; year + '-' + month + '-' + day | day + '/' + month + '/' + year<br />cost -&gt; \d+[\.|,]\d{2}<br />bool -&gt; '1' | 'S' | 'Y' | 'T' | 'True' | '0' | 'N' | 'F' | 'False'<br />year -&gt; \d{4}<br />month -&gt; 1|2|3|4|5|6|7|8|9|10|11|12<br />day -&gt; \d{1,2}<br /></code></pre></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Implementaci&#243;n-con-pyparsing" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Implementaci&#243;n con pyparsing<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Implementaci&#243;n-con-pyparsing" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell unselected rendered" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Las gram&#225;ticas pueden ser un poco intimidantes la primera vez que las ves. Lo bueno de pyparsing es que nos permite testear y modificar las distintas partes de la gram&#225;tica como piezas sueltas. As&#237; podemos crear el parser poco a poco, ensamblando las distinas piezas, con la confianza de que estas funcionan.</div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Parseando-fechas" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Parseando fechas<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Parseando-fechas" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell rendered unselected" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Por ejemplo, para las fechas, que pueden venir en dos formatos, tenemos el siguiente fragmento de la gram&#225;tica (pasado a la sintaxis de pyparsing, y por tanto cambiando el orden, la regla inicial ser&#237;a la &#250;ltima):</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[2]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">from</span> <span class="cm-variable">pyparsing</span> <span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">Literal</span>, <span class="cm-variable">Regex</span>, <span class="cm-variable">oneOf</span>, <span class="cm-variable">StringEnd</span>, <span class="cm-variable">Group</span>, <span class="cm-variable">ParseException</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dash</span> = <span class="cm-variable">Literal</span>(<span class="cm-string" style="color: #ba2121;">'-'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">slash</span> = <span class="cm-variable">Literal</span>(<span class="cm-string" style="color: #ba2121;">'/'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">year</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{4}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">month</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{1,2}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">day</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{1,2}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">date</span> = <span class="cm-variable">year</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">dash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">month</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">dash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">day</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">^</span> <span class="cm-variable">day</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">slash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">month</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">slash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">year</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment" style="color: #408080; font-style: italic;"># pyparsong sobrecarga el operador ^ para indicar alternancia</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 0px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>La clase&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Literal</code>&nbsp;sirve para indicar una expresi&#243;n o token literal, que queremos detectar durante la fase de parseo. As&#237;, definimos&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">dash</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">slash</code>&nbsp;para detectar los literales&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">-</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">/</code>. La clase&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Regex</code>&nbsp;nos permite definir tokens usando expresiones regulares. Estos objetos, as&#237; como el resto de los que veremos, derivan de la clase&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">ParserElement</code>&nbsp;de pyparsing, que sobrecarga varios operadores para poder expresar las reglas de la gram&#225;tica. As&#237;, la regla:</div><pre style="border-radius: 2px; border: 0px; line-height: inherit; margin: 1em 2em; overflow: auto; padding: 0px; white-space: pre-wrap;"><code style="border-radius: 0px; border: 0px; padding: 0px;">date -&gt; year + '-' + month + '-' + day | day + '/' + month + '/' + year<br /></code></pre><div style="margin-top: 1em;">Se puede expresar en Python con los operadores&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">+</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">^</code>:</div><pre style="border-radius: 2px; border: 0px; line-height: inherit; margin: 1em 2em; overflow: auto; padding: 0px; white-space: pre-wrap;"><code style="border-radius: 0px; border: 0px; padding: 0px;">date = year + dash + month + dash + day ^ day + slash + month + slash + year<br /></code></pre><div style="margin-top: 1em;">Aparte de cambios como el uso del operador&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">^</code>, o la definici&#243;n de los literales&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">dash</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">slash</code>, podemos ver que la gram&#225;tica se mapea de forma casi directa a expresiones Python.</div><div style="margin-top: 1em;">Veamos que tal funciona este mini-parser:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[3]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">try</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'hola'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">except</span> <span class="cm-variable">ParseException</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">pass</span>  <span class="cm-comment" style="color: #408080; font-style: italic;"># Ok, no es una fecha</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'25/8/2016'</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'2017-12-08'</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 45.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['25', '/', '8', '/', '2016']<br />['2017', '-', '12', '-', '08']<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>pyparsing define su propia clase de excepciones para errores de Parseo,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">parseException</code>. Si nuestro parser es muy complicado puede ser interesante usar esta misma excepci&#243;n para indicar nuestros propios errores. Por ejemplo, ahora mismo aceptamos para el d&#237;a cualquier combinaci&#243;n de dos d&#237;gitos, e igualmente para el mes:</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[4]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'99/88/2016'</span>))  <span class="cm-comment" style="color: #408080; font-style: italic;"># opps, esto no deber&#237;a valer, pero vale</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['99', '/', '88', '/', '2016']<br /></pre></div></div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>M&#225;s adelante veremos que podemos tratar estos casos y elevar errores explicativos que provoquen el fallo del parser.</div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Por ahora, poco m&#225;s de lo que podr&#237;amos hacer simplemente con expresiones regulares.</div><div style="margin-top: 1em;">Podemos realizar una peque&#241;a mejora. Observemos un detalle de los separadores usados en el formato de fechas, definidos como&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">dash</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">slash</code>; en realidad, sus valores no nos interesan. Podemos calcular el valor de la fecha sin necesidad de saber que caracteres se usaron como separador. Estos elementos son necesarios para el parser, pero no tienen m&#225;s utilidad.</div><div style="margin-top: 1em;">Existe una clase en pyparsing llamada&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Suppress</code>&nbsp;que funciona exactamente igual que&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Literal</code>, pero que retira el token, de forma que nos evitamos procesarlo. Cambiemos la gram&#225;tica para redefinir&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">dash</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">slash</code>&nbsp;usando&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Suppress</code>&nbsp;en vez de&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Literal</code>:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[5]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">from</span> <span class="cm-variable">pyparsing</span> <span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">Suppress</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dash</span> = <span class="cm-variable">Suppress</span>(<span class="cm-string" style="color: #ba2121;">'-'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">slash</span> = <span class="cm-variable">Suppress</span>(<span class="cm-string" style="color: #ba2121;">'/'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">year</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{4}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">month</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{1,2}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">day</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{1,2}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">date</span> = <span class="cm-variable">year</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">dash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">month</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">dash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">day</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">^</span> <span class="cm-variable">day</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">slash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">month</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">slash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">year</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[6]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'23/9/2016'</span>))  <span class="cm-comment" style="color: #408080; font-style: italic;"># bien, el separador desaparece</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['23', '9', '2016']<br /></pre></div></div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>No est&#225; mal, pero la mejora realmente interesante ser&#237;a que nos devolviera algo m&#225;s elaborado, un objeto de tipo fecha, objetos de tipo&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">datetime.datetime</code>, por ejemplo. Vamos a ello. Para eso, necesitamos usar las&nbsp;<strong>reglas de parseo</strong>.</div></div></div></div></h2><h3 id="Reglas-de-parseo" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1; margin: 1.55em 0px 0px;">Reglas de parseo<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Reglas-de-parseo" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell rendered unselected" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div style="margin-top: 1em;">Podemos asociar acciones a las reglas de parseo (en este daso,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">date</code>) para que se ejecuten cada vez qe se active la regla.</div><div style="margin-top: 1em;">Vamos a asociar una funci&#243;n que no haga nada, solo imprimir un valor para ver que, efectivamente, se ejecuta cuando la regla de parseo se activa. Usaremos el m&#233;todo&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">setParseAction</code>:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[7]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">very_simple_action</span>():</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin" style="color: green;">print</span>(<span class="cm-string" style="color: #ba2121;">'OK, se ha ejecutado la acci&#243;n'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">date</span>.<span class="cm-property">setParseAction</span>(<span class="cm-variable">very_simple_action</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'25/8/2016'</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'2017-12-08'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 79.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">OK, se ha ejecutado la acci&#243;n<br />['25', '8', '2016']<br />OK, se ha ejecutado la acci&#243;n<br />['2017', '12', '08']<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>De la documentaci&#243;n de pyparsing, podemos obtener m&#225;s informaci&#243;n sobre como definir y usar estas acciones:</div><div style="margin-top: 1em;">Podemos definir uno o varias acciones a realizar cuando se produce una coincidencia que activa la regla del parser. Estas acciones pueden ser cualquier objeto de tipo&nbsp;<em>callable</em>&nbsp;de python; es decir, funciones, m&#233;todos u objetos instanciados de clases que definan el m&#233;todo m&#225;gico&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">__call__</code>.</div><div style="margin-top: 1em;">Las acciones pueden aceptar desde cero hasta tres argumentos, es decir que, dependiendo de como definamos la acci&#243;n&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">fn</code>, esta ser&#225; llamada como&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">fn()</code>,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">fn(toks)</code>,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">fn(loc, toks)</code>&nbsp;o&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">fn(s, loc, toks)</code>. El significado de estos par&#225;metros es el siguiente:</div><ul style="margin: 1em 2em 0em; padding-left: 0px;"><li><div><code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">s</code>: es la string original que activ&#243; el patr&#243;n de la regla</div></li><li><div><code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">loc</code>: es la localizaci&#243;n, dentro del texto, de la substring&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">s</code>&nbsp;(&#218;til para generar mensajes de error)</div></li><li><div><code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">toks</code>: Una lista de los tokens encontrados, empaquetados en forma de objeto de tipo&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">ParseResults</code></div></li></ul><div style="margin-top: 1em;">Si la funci&#243;n quiere modificar los tokens, debe devolver un nuevo valor como resultado de la funci&#243;n, con lo que la lista de tokens devueltos reemplazar&#237;a a la original. Si no queremos realizar ning&#250;n cambio, la funci&#243;n no debe retornar ning&#250;n valor.</div><div style="margin-top: 1em;">Definamos una acci&#243;n, solo para ver que estos par&#225;metros se pasan efectivamente:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[8]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">I_just_wanna_see</span>(<span class="cm-variable">s</span>, <span class="cm-variable">loc</span>, <span class="cm-variable">tokens</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin" style="color: green;">print</span>(<span class="cm-string" style="color: #ba2121;">'s:'</span>, <span class="cm-variable">s</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin" style="color: green;">print</span>(<span class="cm-string" style="color: #ba2121;">'loc:'</span>, <span class="cm-variable">loc</span>)   </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin" style="color: green;">print</span>(<span class="cm-string" style="color: #ba2121;">'tokens:'</span>, <span class="cm-variable">tokens</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin" style="color: green;">print</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">date</span>.<span class="cm-property">setParseAction</span>(<span class="cm-variable">I_just_wanna_see</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'25/8/2016'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 96.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">s: 25/8/2016<br />loc: 0<br />tokens: ['25', '8', '2016']<br /><br />['25', '8', '2016']<br /></pre></div></div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div><strong>Nota</strong>: Podemos asignar varias acciones usando el m&#233;todo&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">addParseAction</code>. en ese caso, las acciones se ejecutan de forma anidada, siendo la primera en ejecutarse la primera en a&#241;adirse. Cada acci&#243;n recibe como entrada el resultado de la anterior y pasa su resultado a la siguiente. Veamos un ejemplo:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[9]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">token</span> = <span class="cm-variable">Literal</span>(<span class="cm-string" style="color: #ba2121;">'hola'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">token</span>.<span class="cm-property">addParseAction</span>(<span class="cm-keyword" style="color: green; font-weight: bold;">lambda</span> <span class="cm-variable">tokens</span>: <span class="cm-string" style="color: #ba2121;">'ei'</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>] <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-string" style="color: #ba2121;">'ai'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">token</span>.<span class="cm-property">addParseAction</span>(<span class="cm-keyword" style="color: green; font-weight: bold;">lambda</span> <span class="cm-variable">tokens</span>: <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>].<span class="cm-property">upper</span>())</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">token</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'hola'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['EIHOLAAI']<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Si cambiamos el orden en que se a&#241;aden las acciones, el resultado puede diferir, l&#243;gicamente:</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[10]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">token</span> = <span class="cm-variable">Literal</span>(<span class="cm-string" style="color: #ba2121;">'hola'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">token</span>.<span class="cm-property">addParseAction</span>(<span class="cm-keyword" style="color: green; font-weight: bold;">lambda</span> <span class="cm-variable">tokens</span>: <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>].<span class="cm-property">upper</span>())</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">token</span>.<span class="cm-property">addParseAction</span>(<span class="cm-keyword" style="color: green; font-weight: bold;">lambda</span> <span class="cm-variable">tokens</span>: <span class="cm-string" style="color: #ba2121;">'ei'</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>] <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-string" style="color: #ba2121;">'ai'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">token</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'hola'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['eiHOLAai']<br /></pre></div></div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Con esto ya podemos definir una acci&#243;n que nos devuelva un objeto&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">date</code>. Usaremos una acci&#243;n con un solo par&#225;metro,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">tokens</code>, la lista de los tokens detectados, ya que no necesitamos los otros par&#225;metros.</div><div style="margin-top: 1em;">Como devolvemos un valor, el parser sustituir&#225; la lista de tokens detectados por ese nuevo valor.</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[11]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">datetime</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">get_as_date</span>(<span class="cm-variable">tokens</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">first_element</span> = <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">if</span> <span class="cm-builtin" style="color: green;">len</span>(<span class="cm-variable">first_element</span>) == <span class="cm-number" style="color: #008800;">4</span>:  <span class="cm-comment" style="color: #408080; font-style: italic;"># Formato YYYY-MM-DD</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">d</span> = <span class="cm-variable">datetime</span>.<span class="cm-property">date</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>]),  <span class="cm-comment" style="color: #408080; font-style: italic;"># Year</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">1</span>]),  <span class="cm-comment" style="color: #408080; font-style: italic;"># Month</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">2</span>]),  <span class="cm-comment" style="color: #408080; font-style: italic;"># Day</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">else</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-variable">d</span> = <span class="cm-variable">datetime</span>.<span class="cm-property">date</span>(</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">2</span>]),  <span class="cm-comment" style="color: #408080; font-style: italic;"># Year</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">1</span>]),  <span class="cm-comment" style="color: #408080; font-style: italic;"># Month</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>]),  <span class="cm-comment" style="color: #408080; font-style: italic;"># Day</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">            )</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">return</span> <span class="cm-variable">d</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">date</span>.<span class="cm-property">setParseAction</span>(<span class="cm-variable">get_as_date</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'25/8/2016'</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">date</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'2017-12-08'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 45.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">[datetime.date(2016, 8, 25)]<br />[datetime.date(2017, 12, 8)]<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Vamos-a-parsear-valores-l&#243;gicos" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Vamos a parsear valores l&#243;gicos<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Vamos-a-parsear-valores-l&#243;gicos" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell unselected rendered" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Podemos hacer algo similar con los objetos booleanos. Usaremos una de las funciones auxiliares de pyparsing,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">oneOf</code>, que nos permite definir de forma r&#225;pida un conjunto de literales alternativos. Adem&#225;s se asegura de que siempre intentar&#225; capturar el literal m&#225;s grande, en caso de que haya conflicto entre alguno de ellos; por ejemplo, entre&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">&lt;</code>&nbsp;y&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">&lt;=</code>&nbsp;primero intentar&#225; encontrar una correspondencia con el m&#225;s largo,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">&lt;=</code>, y si no la encuentra lo intentar&#225; con&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">&lt;</code>.</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[12]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">from</span> <span class="cm-variable">pyparsing</span> <span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">oneOf</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">boolean</span> = <span class="cm-variable">oneOf</span>(<span class="cm-string" style="color: #ba2121;">'1 S Y T True 0 N F False'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'True'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['True']<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Con un poco de m&#225;gia en forma de acci&#243;n asociada a la regla obtendremos valores booleanos de Python. LA API de pyparsing es fluida, por lo que podemos definir la regla y asociar la acci&#243;n en una sola l&#237;nea:</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[13]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">get_as_bool</span>(<span class="cm-variable">tokens</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">return</span> <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>] <span class="cm-keyword" style="color: green; font-weight: bold;">in</span> (<span class="cm-string" style="color: #ba2121;">'1'</span>, <span class="cm-string" style="color: #ba2121;">'S'</span>, <span class="cm-string" style="color: #ba2121;">'Y'</span>, <span class="cm-string" style="color: #ba2121;">'T'</span>, <span class="cm-string" style="color: #ba2121;">'True'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">boolean</span> = <span class="cm-variable">oneOf</span>(<span class="cm-string" style="color: #ba2121;">'1 S Y T True 0 N F False'</span>).<span class="cm-property">setParseAction</span>(<span class="cm-variable">get_as_bool</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment" style="color: #408080; font-style: italic;"># simple tests</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'1'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">True</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'S'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">True</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'Y'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">True</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'T'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">True</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'True'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">True</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'0'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">False</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'N'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">False</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'F'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">False</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">boolean</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'False'</span>).<span class="cm-property">pop</span>() <span class="cm-keyword" style="color: green; font-weight: bold;">is</span> <span class="cm-keyword" style="color: green; font-weight: bold;">False</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 0px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Parsear-los-importes" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Parsear los importes<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Parsear-los-importes" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell unselected rendered" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div style="margin-top: 1em;">Nos queda el problema de los importes, que pueden usar como separador decimal la coma, al estilo espa&#241;ol, o el punto, al estilo internacional, y las cadenas de textos, que pueden venir limitadas por comillas o no. Los dos casos son f&#225;ciles de tratar:</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[14]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">from</span> <span class="cm-variable">pyparsing</span> <span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">nums</span>, <span class="cm-variable">Word</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span> = <span class="cm-variable">Word</span>(<span class="cm-variable">nums</span>) <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">oneOf</span>(<span class="cm-string" style="color: #ba2121;">'. ,'</span>) <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d\d'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'3819.24'</span>)</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt output_prompt" style="color: #d84315; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">Out[14]:</div><div class="output_subarea output_text output_result"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">(['3819', '.', '24'], {})</pre></div></div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>La clase&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Word</code>&nbsp;nos permite definir una palabra, pasandole uno o dos par&#225;metros, que son vocabularios. Los vocabularios se pueden indicar con una string de s&#237;mbolos, como&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">'aeiou'</code>.&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">nums</code>&nbsp;es solo una constante definida en pyparsing que vale&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">'0123456789'</code>. Podiamos haber usado una expresi&#243;n regular, pero&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Word</code>&nbsp;es bastante interesante.</div><div style="margin-top: 1em;">Si a&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Word</code>&nbsp;se le pasa un solo vocabulario, define una palabra como una secuencia de n caracteres tomados de los s&#237;mbolos definidos en el vocabulario.</div><div style="margin-top: 1em;">Si se le pasan dos vocabularios, define una palabra como una secuencia donde el primer caracter debe pertenecer al primer vocabulario y el resto, si los hubiera, al segundo. Por ejemplo, podemos definir un parser para los nombres v&#225;lidos de Python, que permiten el uso de carateres alfanum&#233;ricos y el car&#225;cter subrayado, pero no no se permiten que empiece por un d&#237;gito:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[15]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">from</span> <span class="cm-variable">pyparsing</span> <span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">alphas</span>, <span class="cm-variable">nums</span>, <span class="cm-variable">alphanums</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">alphas</span> == <span class="cm-string" style="color: #ba2121;">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">alphanums</span> == <span class="cm-variable">alphas</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">nums</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">var_name</span> = <span class="cm-variable">Word</span>(<span class="cm-variable">alphas</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-string" style="color: #ba2121;">'_'</span>, <span class="cm-variable">alphanums</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-string" style="color: #ba2121;">'_'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">var_name</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'a'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">var_name</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'a1'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">var_name</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'alp_ha'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">try</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">var_name</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'1uno'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">except</span> <span class="cm-variable">ParseException</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-comment" style="color: #408080; font-style: italic;"># Oops, no se permite el caracter '_'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">pass</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Definamos otra patr&#243;n, incluyendo el s&#237;mbolo dolar como caracter v&#225;lido al principio, PERL-style:</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[16]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">var_name_plus</span> = <span class="cm-variable">Word</span>(<span class="cm-variable">alphas</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-string" style="color: #ba2121;">'$'</span>, <span class="cm-variable">alphanums</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-string" style="color: #ba2121;">'_'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">var_name_plus</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'a'</span>).<span class="cm-property">pop</span>() == <span class="cm-string" style="color: #ba2121;">'a'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">var_name_plus</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'$_alpha'</span>).<span class="cm-property">pop</span>() == <span class="cm-string" style="color: #ba2121;">'$_alpha'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">var_name_plus</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'$Alpha_plus'</span>).<span class="cm-property">pop</span>() == <span class="cm-string" style="color: #ba2121;">'$Alpha_plus'</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 0px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Hecha esta disgresi&#243;n, volvamos al problema de tratar los importes. A&#241;adamos una acci&#243;n para obtener un n&#250;mero de tipo Decimal:</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[17]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">from</span> <span class="cm-variable">decimal</span> <span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">Decimal</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">get_as_decimal</span>(<span class="cm-variable">tokens</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">int_part</span>, <span class="cm-variable">dec_part</span> = <span class="cm-variable">tokens</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">return</span> <span class="cm-variable">Decimal</span>(<span class="cm-string" style="color: #ba2121;">'{}.{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">int_part</span>, <span class="cm-variable">dec_part</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span> = <span class="cm-variable">Word</span>(<span class="cm-variable">nums</span>) <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">Suppress</span>(<span class="cm-variable">oneOf</span>(<span class="cm-string" style="color: #ba2121;">'. ,'</span>)) <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d\d'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span>.<span class="cm-property">setParseAction</span>(<span class="cm-variable">get_as_decimal</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'484432,23'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">num_esp</span> = <span class="cm-variable">cost</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'484432,23'</span>).<span class="cm-property">pop</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">num_int</span> = <span class="cm-variable">cost</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'484432.23'</span>).<span class="cm-property">pop</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">num_esp</span> == <span class="cm-variable">num_int</span> == <span class="cm-variable">Decimal</span>(<span class="cm-string" style="color: #ba2121;">'484432.23'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">cost</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'3.14'</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">[Decimal('3.14')]<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Cadenas-de-texto-con-o-sin-delimitador" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Cadenas de texto con o sin delimitador<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Cadenas-de-texto-con-o-sin-delimitador" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell unselected rendered" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div style="margin-top: 1em;">Para poder procesar las cadenas de texto, ignorando si procede las comillas delimitadoras opcionales, podemos hacer:</div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[18]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">quote</span> = <span class="cm-variable">Suppress</span>(<span class="cm-string" style="color: #ba2121;">'"'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">content</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">"[^\";]+"</span>) <span class="cm-comment" style="color: #408080; font-style: italic;"># Cualquier secuencia de caracteres, excepto ; y "</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text</span> = <span class="cm-variable">quote</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">content</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">quote</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">^</span> <span class="cm-variable">content</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">text</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'Texto sin comillas'</span>).<span class="cm-property">pop</span>() == <span class="cm-string" style="color: #ba2121;">'Texto sin comillas'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">assert</span> <span class="cm-variable">text</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'"Texto con comillas"'</span>).<span class="cm-property">pop</span>() == <span class="cm-string" style="color: #ba2121;">'Texto con comillas'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    </span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 0px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Bueno, ha sido un viaje un poco largo, con paradas en algunos puntos interesantes, pero ya podemos escribir la gram&#225;tica completa, junto al parser y las acciones aplicadas:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[19]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">from</span> <span class="cm-variable">pyparsing</span> <span class="cm-keyword" style="color: green; font-weight: bold;">import</span> <span class="cm-variable">OneOrMore</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment" style="color: #408080; font-style: italic;"># Funciones de conversion</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">get_as_decimal</span>(<span class="cm-variable">s</span>, <span class="cm-variable">lok</span>, <span class="cm-variable">tokens</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">int_part</span>, <span class="cm-variable">_sep</span>, <span class="cm-variable">dec_part</span> = <span class="cm-variable">tokens</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">return</span> <span class="cm-variable">Decimal</span>(<span class="cm-string" style="color: #ba2121;">'{}.{}'</span>.<span class="cm-property">format</span>(<span class="cm-variable">int_part</span>, <span class="cm-variable">dec_part</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">get_as_date</span>(<span class="cm-variable">s</span>, <span class="cm-variable">loc</span>, <span class="cm-variable">tokens</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">a</span>, <span class="cm-variable">b</span>, <span class="cm-variable">c</span> = <span class="cm-variable">tokens</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">if</span> <span class="cm-builtin" style="color: green;">len</span>(<span class="cm-variable">a</span>) == <span class="cm-number" style="color: #008800;">4</span>:  <span class="cm-comment" style="color: #408080; font-style: italic;"># Formato YYYY-MM-DD</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword" style="color: green; font-weight: bold;">return</span> <span class="cm-variable">datetime</span>.<span class="cm-property">date</span>(<span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">a</span>), <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">b</span>), <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">c</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">else</span>:  <span class="cm-comment" style="color: #408080; font-style: italic;"># Formato DD/MM/YYYY</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-keyword" style="color: green; font-weight: bold;">return</span> <span class="cm-variable">datetime</span>.<span class="cm-property">date</span>(<span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">c</span>), <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">b</span>), <span class="cm-builtin" style="color: green;">int</span>(<span class="cm-variable">a</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">def</span> <span class="cm-def" style="color: blue;">get_as_bool</span>(<span class="cm-variable">s</span>, <span class="cm-variable">loc</span>, <span class="cm-variable">tokens</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">return</span> <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>] <span class="cm-keyword" style="color: green; font-weight: bold;">in</span> (<span class="cm-string" style="color: #ba2121;">'1'</span>, <span class="cm-string" style="color: #ba2121;">'S'</span>, <span class="cm-string" style="color: #ba2121;">'Y'</span>, <span class="cm-string" style="color: #ba2121;">'T'</span>, <span class="cm-string" style="color: #ba2121;">'True'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">sep</span> = <span class="cm-variable">Suppress</span>(<span class="cm-string" style="color: #ba2121;">';'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">quote</span> = <span class="cm-variable">Suppress</span>(<span class="cm-string" style="color: #ba2121;">'"'</span>) <span class="cm-comment" style="color: #408080; font-style: italic;"># Texto</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">content</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">"[^\";]+"</span>) <span class="cm-comment" style="color: #408080; font-style: italic;"># Cualquier secuencia de caracteres, excepto ; y "</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text</span> = <span class="cm-variable">quote</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">content</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">quote</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">^</span> <span class="cm-variable">content</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">text</span>.<span class="cm-property">setParseAction</span>(<span class="cm-keyword" style="color: green; font-weight: bold;">lambda</span> <span class="cm-variable">tokens</span>: <span class="cm-variable">tokens</span>[<span class="cm-number" style="color: #008800;">0</span>].<span class="cm-property">strip</span>())</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">boolean</span> = <span class="cm-variable">oneOf</span>(<span class="cm-string" style="color: #ba2121;">'1 S Y T True 0 N F False'</span>) <span class="cm-comment" style="color: #408080; font-style: italic;"># Valores l&#243;gicos</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">boolean</span>.<span class="cm-property">setParseAction</span>(<span class="cm-variable">get_as_bool</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dash</span> = <span class="cm-variable">Suppress</span>(<span class="cm-string" style="color: #ba2121;">'-'</span>) <span class="cm-comment" style="color: #408080; font-style: italic;"># Fechas</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">slash</span> = <span class="cm-variable">Suppress</span>(<span class="cm-string" style="color: #ba2121;">'/'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">year</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{4}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">month</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{1,2}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">day</span> = <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d{1,2}'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">date</span> = <span class="cm-variable">year</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">dash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">month</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">dash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">day</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">^</span> <span class="cm-variable">day</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">slash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">month</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">slash</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">year</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">date</span>.<span class="cm-property">setParseAction</span>(<span class="cm-variable">get_as_date</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span> = <span class="cm-variable">Word</span>(<span class="cm-variable">nums</span>) <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">oneOf</span>(<span class="cm-string" style="color: #ba2121;">'. ,'</span>) <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'\d\d'</span>)  <span class="cm-comment" style="color: #408080; font-style: italic;"># Importes</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cost</span>.<span class="cm-property">setParseAction</span>(<span class="cm-variable">get_as_decimal</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">line</span> = <span class="cm-variable">Group</span>(<span class="cm-variable">text</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">sep</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">boolean</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">sep</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">date</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">sep</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">cost</span>)  <span class="cm-comment" style="color: #408080; font-style: italic;"># One Line</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lines</span> = <span class="cm-variable">OneOrMore</span>(<span class="cm-variable">line</span>)  <span class="cm-comment" style="color: #408080; font-style: italic;"># Lines</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">lines</span>.<span class="cm-property">setParseAction</span>(<span class="cm-keyword" style="color: green; font-weight: bold;">lambda</span> <span class="cm-variable">tokens</span>: <span class="cm-builtin" style="color: green;">list</span>(<span class="cm-variable">tokens</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">header</span> = <span class="cm-variable">Suppress</span>(<span class="cm-variable">Regex</span>(<span class="cm-string" style="color: #ba2121;">'.+'</span>))  <span class="cm-comment" style="color: #408080; font-style: italic;"># Header</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">parser</span> = <span class="cm-variable">header</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">lines</span> <span class="cm-operator" style="color: #aa22ff; font-weight: bold;">+</span> <span class="cm-variable">StringEnd</span>() <span class="cm-comment" style="color: #408080; font-style: italic;"># First rule</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 0px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><ul style="margin: 0em 2em; padding-left: 0px;"><li><div>La clase&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">OneOrMore</code>&nbsp;nos permite implementar las reglas de&nbsp;<em>una secuencia de uno o m&#225;s elementos repetidos</em>, como su mismo nombre indica. Pyparsing define muchos m&#225;s clases de este tipo, como&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">ZeroOrMore</code>,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Optional</code>, (Uno o cero),&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">OnlyOne</code>...</div></li><li><div>La clase&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">Group</code>&nbsp;nos permite agrupar varios tokens en un solo resultado, normalmente porque vamos a tratarlos todos juntos.</div></li><li><div>La clase&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">StringEnd</code>&nbsp;nos permite indicar que el parser, al consumir este token, deber&#237;a de haber terminado, es decir, que todo el texto a parserar debe consumirse &#237;ntegramente.</div></li></ul><div style="margin-top: 1em;">Vamos a hacer unas pruebas parseando l&#237;neas individuales:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[20]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">line</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'Texto sin comillas porque yo lo valgo;Y;2017-08-08;4292.00'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">[['Texto sin comillas porque yo lo valgo', True, datetime.date(2017, 8, 8), Decimal('4292.00')]]<br /></pre></div></div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[21]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">line</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'"Ahora si que pongo comillas";F;25/8/2014;3200.00'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">[['Ahora si que pongo comillas', False, datetime.date(2014, 8, 25), Decimal('3200.00')]]<br /></pre></div></div></div></div></div><div class="cell code_cell unselected rendered" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[22]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">line</span>.<span class="cm-property">parseString</span>(<span class="cm-string" style="color: #ba2121;">'Ya ves, todo vale;True;1/1/1970;4532,02'</span>))</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 28.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">[['Ya ves, todo vale', True, datetime.date(1970, 1, 1), Decimal('4532.02')]]<br /></pre></div></div></div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-default CodeMirror-wrap" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">print(header.parseString('Comentario;Activo;Fecha;Importe'))  # Ignoramos la cabecera</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Y la prueba de fuego, un fichero completo:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[23]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">source</span> = <span class="cm-string" style="color: #ba2121;">'''Comentario;Activo;Fecha;Importe</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string" style="color: #ba2121;">Texto sin comillas porque yo lo valgo;Y;2017-08-08;4292.00</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string" style="color: #ba2121;">"Ahora si que pongo comillas";F;25/8/2014;3200.00</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string" style="color: #ba2121;">Ya ves, todo vale;True;1/1/1970;4532,02</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string" style="color: #ba2121;">'''</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">g</span> = <span class="cm-variable">parser</span>.<span class="cm-property">parseString</span>(<span class="cm-variable">source</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">for</span> <span class="cm-variable">item</span> <span class="cm-keyword" style="color: green; font-weight: bold;">in</span> <span class="cm-variable">g</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">item</span>)</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 62.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['Texto sin comillas porque yo lo valgo', True, datetime.date(2017, 8, 8), Decimal('4292.00')]<br />['Ahora si que pongo comillas', False, datetime.date(2014, 8, 25), Decimal('3200.00')]<br />['Ya ves, todo vale', True, datetime.date(1970, 1, 1), Decimal('4532.02')]<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><div>Unsado el m&#233;todo&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">parseFile</code>&nbsp;podemos procesar un fichero, si especificamos el nombre, un fichero abierto, o cualquier objeto que implemente una interfaz similar a&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">File</code>:</div></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0.4em; text-align: right;">In&nbsp;[24]:</div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-ipython" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword" style="color: green; font-weight: bold;">with</span> <span class="cm-builtin" style="color: green;">open</span>(<span class="cm-string" style="color: #ba2121;">'ejemplo.csv'</span>, <span class="cm-string" style="color: #ba2121;">'r'</span>) <span class="cm-keyword" style="color: green; font-weight: bold;">as</span> <span class="cm-variable">stream</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-variable">g</span> = <span class="cm-variable">parser</span>.<span class="cm-property">parseFile</span>(<span class="cm-variable">stream</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">    <span class="cm-keyword" style="color: green; font-weight: bold;">for</span> <span class="cm-variable">item</span> <span class="cm-keyword" style="color: green; font-weight: bold;">in</span> <span class="cm-variable">g</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">        <span class="cm-builtin" style="color: green;">print</span>(<span class="cm-variable">item</span>)</span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" style="border-radius: 2px; cursor: default; font-family: monospace; height: 79.1875px; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;" title="click to scroll output; double click to hide"></div><div class="output"><div class="output_area"><div class="prompt" style="cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="output_subarea output_text output_stream output_stdout"><pre style="background-color: transparent; border-radius: 0px; border: 0px; font-size: inherit; line-height: inherit; overflow: auto; padding: 0px; vertical-align: baseline; white-space: pre-wrap;">['Texto sin comillas porque yo lo valgo', True, datetime.date(2017, 8, 8), Decimal('4292.00')]<br />['Ahora si que pongo comillas', False, datetime.date(2014, 8, 25), Decimal('3200.00')]<br />['Ya ves, todo vale', True, datetime.date(1970, 1, 1), Decimal('4532.02')]<br />['Los espacios no son problema', False, datetime.date(2017, 2, 22), Decimal('1203.23')]<br /></pre></div></div></div></div></div><div class="cell text_cell unselected rendered" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h2 id="Ventajas-de-Pyparsing" style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1;">Ventajas de Pyparsing<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Ventajas-de-Pyparsing" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h2><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell unselected rendered" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"></div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div><div class="inner_cell"><div class="input_area" style="background: rgb(247, 247, 247); border-radius: 2px; border: 1px solid rgb(207, 207, 207); line-height: 1.21429em;"><div class="CodeMirror cm-s-default CodeMirror-wrap" style="background: none; font-family: monospace; height: auto; line-height: 1.21429em; overflow: hidden;"><div style="height: 0px; overflow: hidden; width: 3px;"><textarea tabindex="0"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer"><div><div class="CodeMirror-lines" style="cursor: text; padding: 0.4em;"><div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div class="CodeMirror-measure" style="height: 0px; overflow: hidden; width: 972.812px;"></div><div></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="border-left: 1px solid black; border-right: none; height: 17.5px; width: 0px;"></div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2" style="color: #0055aa;">- </span><span class="cm-strong cm-variable-2" style="color: #0055aa; font-weight: bold;">**Robusto y sencillo de usar**</span><span class="cm-variable-2" style="color: #0055aa;">. Pyparsing lleva m&#225;s de una d&#233;cada de desarrollo, y se basa en el uso de gram&#225;ticas para la definici&#243;n formal de lenguajes. El paso de la gram&#225;tica a c&#243;digo Python es casi directo.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2" style="color: #0055aa;">- </span><span class="cm-strong cm-variable-2" style="color: #0055aa; font-weight: bold;">**Desarrollo incremental, facilmente testeable**</span><span class="cm-variable-2" style="color: #0055aa;">. El parser final se puede ir construyendo paso a paso.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2" style="color: #0055aa;">- No se ve en los ejemplo, pero podemos a&#241;adir </span><span class="cm-strong cm-variable-2" style="color: #0055aa; font-weight: bold;">**validaciones y mensajes de error explicativos**</span><span class="cm-variable-2" style="color: #0055aa;"> que simplifican la resoluci&#243;n de problemas --incluyendo, por ejemplo, n&#250;mero de l&#237;nea y posici&#243;n del error. Podemos asignar nombres a los resultados de los tokens para que se&#225;n m&#225;s sencillos de referencias, y muchas otras funcionalidades que no hemos podido ver aqu&#237;.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable-2" style="color: #0055aa;">- </span><span class="cm-strong cm-variable-2" style="color: #0055aa; font-weight: bold;">**Flexible**</span><span class="cm-variable-2" style="color: #0055aa;">, comparado con un parser hecho a mano o en base a un mont&#243;n de espresiones regulares. A modo de ejemplo, v&#233;anse los </span><span class="cm-strong cm-variable-2" style="color: #0055aa; font-weight: bold;">**ejercicios para el lector**</span><span class="cm-variable-2" style="color: #0055aa;">.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span>&#8203;</span></span></pre></div></div></div></div></div><div style="border-bottom: 0px solid transparent; height: 15px; width: 1px;"></div></div></div></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Ejercicios-para-el-lector" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Ejercicios para el lector<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Ejercicios-para-el-lector" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell rendered unselected" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><ul style="margin: 1em 2em 0em; padding-left: 0px;"><li><div>A&#241;adir otro formato v&#225;lido para las fechas, por ejemplo,&nbsp;<code style="border-radius: 2px; border: 0px; padding: 0px; white-space: pre-wrap;">10/abr/2017</code>&nbsp;(10 puntos)</div></li><li><div>Permitir que la &#250;ltima columna, el importe, acepte tambi&#233;n un valor entero, es decir, sin parte decimal (20 puntos)</div></li><li><div>Permitir que los textos puedan venir sin comillas, con comillas simples o con comillas dobles (20 puntos)</div></li><li><div>El jefe ha modificado el formato, el fichero tiene ahora una &#250;ltima &#314;inea donde va el total acumulado de todos los importes previos, algo as&#237;:</div><pre style="border-radius: 2px; border: 0px; line-height: inherit; margin: 1em 2em; overflow: auto; padding: 0px; white-space: pre-wrap;"><code style="border-radius: 0px; border: 0px; padding: 0px;">  Comentario;Activo;Fecha;Importe<br />  Texto sin comillas porque yo lo valgo;Y;2017-08-08;4292.00<br />  "Ahora si que pongo comillas";F;25/8/2014;3200.00<br />  Ya ves, todo vale;True;1/1/1970;4532,02<br />  12024.02<br /></code></pre><div style="margin-top: 1em;">El parser debe adaptarse a este cambio, y comprobar que la suma de los importes coincide con el dato final. Si, ya s&#233; que, t&#233;cnicamente, esto ha dejado de ser un CSV. Estas cosas pasan. (100 puntos y una gran satisfacci&#243;n personal)</div></li></ul></div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt" style="border-top: 1px solid transparent; color: #303f9f; cursor: default; font-family: monospace; line-height: 1.21429em; margin: 0px; padding: 0px 0.4em; text-align: right;"></div></div></h2><h3 id="Mas-informaci&#243;n" style="color: inherit; font-family: inherit; font-size: 18.004px; line-height: 1;">Mas informaci&#243;n<a class="anchor-link" href="http://localhost:8889/notebooks/Ejemplo-uso-pyparsing.ipynb#Mas-informaci&#243;n" style="background-color: transparent; color: #337ab7; padding: 0px 20px;"></a></h3><h2 style="color: inherit; font-family: inherit; font-size: 21.994px; line-height: 1; padding: 0px;"><div class="cell text_cell rendered unselected" tabindex="2"><div class="inner_cell"><div class="text_cell_render rendered_html" style="border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; width: inherit;" tabindex="-1"><ul style="margin: 1em 2em 0em; padding-left: 0px;"><li><div>La p&#225;gina web de pyparsing:&nbsp;<a href="http://pyparsing.wikispaces.com/" style="background-color: transparent; color: #337ab7;" target="_blank">http://pyparsing.wikispaces.com/</a></div></li><li><div>Parsing In Python: Tools And Libraries&nbsp;<a href="https://tomassetti.me/parsing-in-python/" style="background-color: transparent; color: #337ab7;" target="_blank">https://tomassetti.me/parsing-in-python/</a></div></li></ul></div></div></div></h2></div></div></div>
    </div>
</div></div>
<div class="time">
<h3>12:46</h3>
<div class="item feed-207d1418 feed-{feed_id}" id="item-27abf606">
<p class="itemheader">
<span class="itemtitle">
    El Ornitorrinco Enmascarado:
<a href="http://www.elornitorrincoenmascarado.com/2017/05/pybirras-edicion-pre-veranito-1jun2016.html">PyBirras Edici&#243;n Pre-veranito (1/jun/2017)</a></span>
</p>
    <div class="itemdescription">
    <p>El pr&#243;ximo <b>1 de junio, jueves</b>, a partir de las 18:00 tendremos un nuevo encuentro de desarrolladores para hablar de nuestros temas favoritos: desarrollo, unicornios y cervezas. En esta ocasi&#243;n tendremos tres charlas:<br /><ul><li><b>AWS: Desplegando Python en Amazon</b></li><li><b>PyTesting e integraci&#243;n continua con Travis</b></li><li><b>Vue.js: El framework javascript para muggles</b></li></ul>Tras las cuales tendremos la segunda parte: networking, vida social, risas y ping pong. Todo ello en las instalaciones del Equipo Para (C/La Marina, 4, Santa cruz de Tenerife).<br />Por favor, confirmad la asistencia en el meetup, para poner las cervezas a enfriar.<br /><a href="https://www.meetup.com/Agile-Canarias/events/235289799/"><tt>https://www.meetup.com/Agile-Canarias/events/235289799/</tt></a><br />Esta vez nos hemos venido arriba y tenemos hasta cartel promocional:<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-2b-k4_jfxSU/WSLJ8a_z74I/AAAAAAAAIlk/lP-MxKQi3esHwDcH_wcmQiLOM54JHOY4gCLcB/s1600/cartel.pybirras-junio-2017-xs.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://2.bp.blogspot.com/-2b-k4_jfxSU/WSLJ8a_z74I/AAAAAAAAIlk/lP-MxKQi3esHwDcH_wcmQiLOM54JHOY4gCLcB/s1600/cartel.pybirras-junio-2017-xs.png" /></a></div>
    </div>
</div></div>
</div>

</div>
<div id="feedstats">
    <div id="xmls">
        
    <a href="foafroll.xml"><img src="foaf.png" title="FOAF" alt="FOAF" /></a>
    <a href="opml.xml"><img src="opml.png" title="OPML" alt="OPML" /></a>
    <a href="rss.xml"><img src="rss.png" title="RSS" alt="RSS" /></a>

    </div>
    <h2 id="feedmain"><a href="http://es.python.org" style="color: black; font-size: 20px; text-decoration: none;"><span style="color:#d40000">e</span><span style="color:#f3b52c">s</span>.<span style="color:#43648b">pyt</span><span style="color:#f3b52c">hon</span>.org</a></h2>
    <h2 id="feedlaststatus">Estado</h2>
    <div id="log">
        
    <a href="log.html">Estado de fuentes</a>

    </div>
    <h2 id="feedsarchive">Archivo</h2>
    <div id="archive">
        <table class="calendar">
<tr class="cal-head">
<td class="cal-prev"><a href="index-2017-07-24.html">&lt;</a></td>
<td class="cal-month" colspan="5">agosto 2017</td>
<td class="cal-next"></td>
</tr>
<tr class="cal-days">
<th>lun</th><th>mar</th><th>mi&#233;</th><th>jue</th><th>vie</th><th>s&#225;b</th><th>dom</th></tr>
<tr class="cal-week">
<td class="cal-day"><em class="cal-othermonth">31</em></td><td class="cal-day">01</td><td class="cal-day">02</td><td class="cal-day">03</td><td class="cal-day">04</td><td class="cal-day">05</td><td class="cal-day">06</td></tr>
<tr class="cal-week">
<td class="cal-day">07</td><td class="cal-day">08</td><td class="cal-day"><strong class="cal-current">09</strong></td><td class="cal-day">10</td><td class="cal-day">11</td><td class="cal-day">12</td><td class="cal-day">13</td></tr>
<tr class="cal-week">
<td class="cal-day">14</td><td class="cal-day">15</td><td class="cal-day">16</td><td class="cal-day">17</td><td class="cal-day">18</td><td class="cal-day">19</td><td class="cal-day">20</td></tr>
<tr class="cal-week">
<td class="cal-day">21</td><td class="cal-day">22</td><td class="cal-day">23</td><td class="cal-day">24</td><td class="cal-day">25</td><td class="cal-day">26</td><td class="cal-day">27</td></tr>
<tr class="cal-week">
<td class="cal-day">28</td><td class="cal-day">29</td><td class="cal-day">30</td><td class="cal-day">31</td><td class="cal-day"><em class="cal-othermonth">01</em></td><td class="cal-day"><em class="cal-othermonth">02</em></td><td class="cal-day"><em class="cal-othermonth">03</em></td></tr>
</table>

    </div>
    <h2 id="feedsblogs">Blogs</h2>
    <div id="feedlist">
        
    
<a href="http://maengora.blogspot.com/search/label/python">Actualidad Informatica</a>
<a href="http://maengora.blogspot.com/feeds/posts/default/-/python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="">Alfffa Solutions</a>
<a href="http://alfffa.net/blog/category/informatica/programacion/python/feed/"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="">codeplasticlesthack</a>
<a href="http://lesthack.com.mx/category/programacion/python/feed/"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="">Dead Epsilon</a>
<a href="https://juanlu001.github.io/rss.xml"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://www.eferro.net/search/label/Python">e-ferro</a>
<a href="http://www.eferro.net/feeds/posts/default/-/Python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="https://www.atareao.es">El Atareao</a>
<a href="http://feeds.feedburner.com/ElAtareao_python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://www.elornitorrincoenmascarado.com/search/label/python">El Ornitorrinco Enmascarado</a>
<a href="http://www.elornitorrincoenmascarado.com/feeds/posts/default/-/python/?alt=rss"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://elviajedelnavegante.blogspot.com/search/label/python">El viaje del navegante</a>
<a href="http://elviajedelnavegante.blogspot.com/feeds/posts/default/-/python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="https://www.freakspot.net/">Freak Spot</a>
<a href="https://www.freakspot.net/feeds/python.atom.xml"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="">Frogblog</a>
<a href="http://blog.willinux.net/?cat=14&feed=rss2"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="https://www.genbetadev.com">Genbeta:dev</a>
<a href="https://www.genbetadev.com/categoria/python/rss2.xml"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://blog.ch3m4.org/">Hyperreals *R</a>
<a href="http://blog.ch3m4.org/feeds/python.atom.xml"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="">JavAguirre.net</a>
<a href="http://javaguirre.me/python.xml"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://blep.blogspot.com/search/label/python">Javier Santana</a>
<a href="http://blep.blogspot.com/feeds/posts/default/-/python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://joedicastro.com">joe di castro</a>
<a href="http://joedicastro.com/rss.xml"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://blog.crespo.org.ve/search/label/python">La libertad de desarrollar...</a>
<a href="http://blog.crespo.org.ve/feeds/posts/default/-/python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="">Monobot</a>
<a href="http://monobotblog.alvarezalonso.es/archives/category/python/feed"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://mundo-python.blogspot.com/">Mundo Python</a>
<a href="http://mundo-python.blogspot.com/feeds/posts/default"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://www.userlinux.net">oscarmlage</a>
<a href="https://userlinux.net/tag-python/feed/"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="https://pybonacci.wordpress.com">Pybonacci</a>
<a href="https://pybonacci.wordpress.com/feed/"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://blog-es.python.org/">Python Insider ES</a>
<a href="http://feeds.feedburner.com/PythonInsiderES"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="">Read The Fucking Docs</a>
<a href="http://readthefuckingdocumentation.blogspot.com/feeds/posts/default/-/python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="http://simelo-es.blogspot.com/search/label/python">Simelo pides...</a>
<a href="http://simelo-es.blogspot.com/feeds/posts/default/-/python"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="https://beastieux.com">The::Beastieux</a>
<a href="https://beastieux.com/category/python/feed/"><img src="feed-icon.png" alt=""/></a>
<br />
<a href="https://unoyunodiez.com">Uno y uno = diez</a>
<a href="https://unoyunodiez.com/tag/python-2/feed/"><img src="feed-icon.png" alt=""/></a>
<br />

    </div>
</div>
<div id="footer">
<p id="aboutrawdog">Generado por
<a href="http://offog.org/code/rawdog.html">rawdog</a>
version 2.22rc1
by <a href="mailto:ats@offog.org">Adam Sampson</a>.</p>
<p>Theme por <a href="http://code.joedicastro.com/my-rawdog-planet">joe di castro</a>. Basado en el <a href="http://github.com/ralsina/planeta-pyar/tree/master">trabajo de Roberto Alsina</a> para PyAr</p>
<p>


</p>
</div>
</body>
</html>
